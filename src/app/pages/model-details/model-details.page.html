<ion-header [translucent]="true">
  <ion-toolbar color="primary">
    <ion-buttons slot="start">
      <ion-back-button defaultHref="/models"></ion-back-button>
    </ion-buttons>
    <ion-title>Model Details</ion-title>
    <ion-buttons slot="end">
      <ion-button (click)="deleteModel()" color="danger" fill="clear">
        <ion-icon slot="icon-only" name="trash"></ion-icon>
      </ion-button>
    </ion-buttons>
  </ion-toolbar>
</ion-header>

<ion-content [fullscreen]="true" class="ion-padding">
  <!-- Loading State -->
  <div *ngIf="isLoading" class="ion-text-center ion-padding">
    <ion-spinner></ion-spinner>
    <p>Loading model details...</p>
  </div>

  <!-- Error State -->
  <div *ngIf="error && !isLoading" class="ion-text-center ion-padding">
    <ion-icon name="warning" size="large" color="danger"></ion-icon>
    <p>{{ error }}</p>
    <ion-button (click)="modelId && loadModel(modelId)" fill="outline">
      <ion-icon slot="start" name="refresh"></ion-icon>
      Try Again
    </ion-button>
  </div>

  <!-- Model Details -->
  <div *ngIf="!isLoading && model" class="model-details">
    <ion-card>
      <ion-card-header>
        <div class="model-header">
          <ng-container *ngIf="model.versions && model.versions.length > 0 && model.versions[0].files && model.versions[0].files.length > 0">
            <div class="model-title">
              <h1>{{ model.modelName }}</h1>
              <div class="model-meta">
                <ion-badge color="light">
                  v{{ model.versions[0].version_Number }}
                </ion-badge>
                <ion-note>Uploaded {{ model.versions[0].files[0].uploadDate | date:'mediumDate' }}</ion-note>
              </div>
            </div>
          </ng-container>
        </div>
      </ion-card-header>

      <ion-card-content>
        <div class="model-description">
          <h3>Description</h3>
          <p>{{ model.description || 'No description provided.' }}</p>
        </div>

        <ion-list lines="none" class="model-info" *ngIf="model.versions && model.versions.length > 0 && model.versions[0].files && model.versions[0].files.length > 0">
          <ion-item>
            <ion-label>File Name</ion-label>
            <ion-note slot="end">{{ model.versions[0].files[0].fileName }}</ion-note>
          </ion-item>
          <ion-item>
            <ion-label>File Size</ion-label>
            <ion-note slot="end">{{ formatFileSize(model.versions[0].files[0].fileSize) }}</ion-note>
          </ion-item>

          <ion-item>
            <ion-label>Upload Date</ion-label>
            <ion-note slot="end">{{ model.versions[0].files[0].uploadDate | date:'medium' }}</ion-note>
          </ion-item>
        </ion-list>

        <!-- Tags are not present on ModelDetails; add here if you want to display tags from file or version -->

      </ion-card-content>
    </ion-card>

    <div class="action-buttons">
  <ion-button expand="block" (click)="downloadModel()" color="primary">
    <ion-icon slot="start" name="cloud-download"></ion-icon>
    Download Model
  </ion-button>
  <ion-button expand="block" color="primary" (click)="startTraining()">
    <ion-icon slot="start" name="rocket-outline"></ion-icon>
    Start Training
  </ion-button>
</div>
  </div>
</ion-content>
